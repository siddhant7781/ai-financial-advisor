<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Financial Advisor</title>
  <link rel="stylesheet" href="/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <main class="container">
    <header style="margin-bottom: 2rem; text-align: center;">
      <h1>AI Financial Advisor</h1>
      <p class="muted">Smart, personalized investment strategies powered by data and AI.</p>
    </header>

    <div class="main-layout">
      <div class="left-panel">
        <section class="card">
          <h2>Your Profile</h2>
          <form id="profileForm">
            <label>
              Investment Horizon
              <select name="horizon">
                <option value="<2y">&lt; 2 Years</option>
                <option value="2-5y">2 - 5 Years</option>
                <option value="5-10y" selected>5 - 10 Years</option>
                <option value="10y+">10+ Years</option>
              </select>
            </label>

            <label>
              Risk Tolerance (1-5)
              <input name="risk" type="number" min="1" max="5" value="3" />
            </label>

            <label>
              Max Drawdown Tolerance
              <select name="drawdown">
                <option value="5%">5% (Conservative)</option>
                <option value="10%">10% (Moderate)</option>
                <option value="20%+" selected>20%+ (Aggressive)</option>
              </select>
            </label>

            <label>
              Liquidity Needs
              <select name="liquidity">
                <option>Monthly</option>
                <option>Quarterly</option>
                <option selected>Annual</option>
              </select>
            </label>

            <label>
              Primary Goal
              <select name="goal">
                <option value="growth">Capital Growth</option>
                <option value="income">Income & Stability</option>
                <option value="balanced" selected>Balanced</option>
              </select>
            </label>

            <label>
              Rebalance Frequency
              <select name="rebalance">
                <option>Quarterly</option>
                <option>Semiannual</option>
                <option selected>Annual</option>
              </select>
            </label>

            <label>
              Tax Sensitivity
              <select name="tax">
                <option>Low</option>
                <option selected>Medium</option>
                <option>High</option>
              </select>
            </label>

            <fieldset class="full-width checkbox-group">
              <legend>Preferences & Constraints</legend>
              <label><input type="checkbox" name="constraints" value="Avoid EM" /> Avoid Emerging Markets</label>
              <label><input type="checkbox" name="constraints" value="Avoid REITs" /> Avoid REITs</label>
              <label><input type="checkbox" name="constraints" value="Avoid commodities" /> Avoid Commodities</label>
              <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 0.5rem;">
                <label><input type="checkbox" name="useLLM" value="1" /> <strong>Enable AI Analysis
                    (OpenAI)</strong></label>
              </div>
            </fieldset>

            <div class="actions">
              <button type="submit">Get Recommendation</button>
            </div>
          </form>
        </section>

        <section class="card">
          <h2>ETF Universe</h2>
          <p class="muted" style="margin-bottom: 1.5rem;">The set of assets considered for your portfolio.</p>
          <ul id="universe"></ul>
        </section>
      </div>

      <div class="right-panel">
        <section id="result" class="card">
          <div id="resultPlaceholder" class="placeholder-state">
            <div class="placeholder-icon">ðŸ“Š</div>
            <h3>Ready to Generate</h3>
            <p>Adjust your profile on the left and click "Get Recommendation" to see your personalized portfolio
              strategy.</p>
          </div>

          <div id="resultContent" class="hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
              <h2>Recommended Allocation</h2>
              <div id="explainControls">
                <span id="chartMode">Mode: rule-based</span>
                <button id="btnShowRule" disabled>Rule-Based</button>
                <button id="btnShowLLM" disabled>AI Model</button>
              </div>
            </div>

            <div class="results-grid">
              <div class="chart-column">
                <div class="chart-container">
                  <canvas id="mainAllocChart"></canvas>
                </div>
                <div style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-muted); text-align: center;">
                  Click a slice to view chart below
                </div>
              </div>

              <div class="details-container">
                <div id="explain" class="explain-block"></div> <!-- Hidden by default, shown by JS for loading/error -->
                <div id="explainRule" class="explain-block"></div>
                <div id="explainLLM" class="explain-block hidden"></div>
              </div>
            </div>

            <div style="margin-top: 2rem;">
              <h3>Market Data</h3>
              <div id="tv_chart_container"
                style="width:100%; height:400px; border-radius: var(--radius); overflow: hidden; border: 1px solid var(--border);">
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>

  </main>
  <script src="/app.js"></script>
  <script src="https://s3.tradingview.com/tv.js"></script>
</body>

</html>